--- a/providers/implementations/signature/rsa_sig.c
+++ b/providers/implementations/signature/rsa_sig.c
@@ -402,19 +402,15 @@ static int rsa_setup_md(PROV_RSA_CTX *ctx, const char *mdname,
             ERR_raise(ERR_LIB_PROV, PROV_R_XOF_DIGESTS_NOT_ALLOWED);
             goto err;
         }
-#ifdef FIPS_MODULE
+        /* Restrict SHA1 for signing operations (FIPS baseline) */
         {
-            int sha1_allowed
-                = ((ctx->operation
-                    & (EVP_PKEY_OP_SIGN | EVP_PKEY_OP_SIGNMSG)) == 0);
+            int is_signing = ((ctx->operation
+                               & (EVP_PKEY_OP_SIGN | EVP_PKEY_OP_SIGNMSG)) != 0);

-            if (!ossl_fips_ind_digest_sign_check(OSSL_FIPS_IND_GET(ctx),
-                                                 OSSL_FIPS_IND_SETTABLE1,
-                                                 ctx->libctx,
-                                                 md_nid, sha1_allowed, desc,
-                                                 ossl_fips_config_signature_digest_check))
+            if (is_signing && md_nid == NID_sha1) {
+                ERR_raise(ERR_LIB_PROV, PROV_R_INVALID_DIGEST);
                 goto err;
+            }
         }
-#endif

         if (!rsa_check_padding(ctx, mdname, NULL, md_nid))
             goto err;
