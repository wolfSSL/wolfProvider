--- a/providers/implementations/signature/ecdsa_sig.c
+++ b/providers/implementations/signature/ecdsa_sig.c
@@ -210,20 +210,16 @@
         goto err;
     }

-#ifdef FIPS_MODULE
+    /* Restrict SHA1 for signing operations (FIPS baseline) */
     {
-        int sha1_allowed
-            = ((ctx->operation
-                & (EVP_PKEY_OP_SIGN | EVP_PKEY_OP_SIGNMSG)) == 0);
+        int is_signing = ((ctx->operation
+                           & (EVP_PKEY_OP_SIGN | EVP_PKEY_OP_SIGNMSG)) != 0);

-        if (!ossl_fips_ind_digest_sign_check(OSSL_FIPS_IND_GET(ctx),
-                                             OSSL_FIPS_IND_SETTABLE1,
-                                             ctx->libctx,
-                                             md_nid, sha1_allowed, 0, desc,
-                                             ossl_fips_config_signature_digest_check))
+        if (is_signing && md_nid == NID_sha1) {
+            ERR_raise(ERR_LIB_PROV, PROV_R_INVALID_DIGEST);
             goto err;
+        }
     }
-#endif

     if (!ctx->flag_allow_md) {
         if (ctx->mdname[0] != '\0' && !EVP_MD_is_a(md, ctx->mdname)) {
